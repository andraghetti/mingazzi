%-----------------------------------------------------------------------------
%	REQUIRED PACKAGES
%-----------------------------------------------------------------------------

\usepackage[utf8]{inputenc} % Required for inputting international characters
\usepackage[T1]{fontenc} % Output font encoding for international characters
\usepackage[italian]{babel}
\usepackage[osf]{libertine} % Use the Libertine font
\usepackage{microtype} % Improves character and word spacing

%for calligraphy
\usepackage{calligra}
\usepackage[T1]{fontenc}
%similar to calligra
\let\hbar\relax
\usepackage{fontspec}
\newfontfamily\textcal[Ligatures=TeX]{Tangerine}


%for index layout
\usepackage{imakeidx}

%images
\usepackage{graphicx}
\graphicspath{ {images/} }
\usepackage{wrapfig}
\usepackage{lipsum}
\usepackage{subfig}
\usepackage{subfloat}


%\usepackage[none]{hyphenat} %evitare la trocatura delle parole
\hyphenation{a-gen-tiz-za-zio-ne}
\pretolerance=10000
\tolerance=9000 
\emergencystretch=0pt
\righthyphenmin=4
\lefthyphenmin=4

\usepackage{tikz} % Required for drawing custom shapes
\definecolor[named]{color01}{rgb}{0.1,0.4,0.6} % Color used in the title page
\usepackage{wallpaper} % Required for setting background images (title page)

\usepackage[unicode=true,bookmarks=true,bookmarksnumbered=false,bookmarksopen=false,breaklinks=false,pdfborder={0 0 1},backref=section,colorlinks=false]{hyperref} % PDF meta-information specification


%-----------------------------------------------------------------------------
%	TABLE OF CONTENTS (INDICE)
%-----------------------------------------------------------------------------
\usepackage{tocloft}


%-----------------------------------------------------------------------------
%	PAPER, MARGIN AND HEADER/FOOTER SIZES
%-----------------------------------------------------------------------------

\setstocksize{18.5cm}{13cm} % Paper size
\settrimmedsize{\stockheight}{\stockwidth}{*} % No trims
\setlrmarginsandblock{1.5cm}{1.5cm}{*}% % Left/right margins
\setulmarginsandblock{1.5cm}{1.5cm}{*} % Top/bottom margins
\setheadfoot{15pt}{19pt} % Header/footer height
%\setheaderspaces{*}{8pt}{*} % Extra header space

%-----------------------------------------------------------------------------
%	FOOTNOTE CUSTOMIZATION
%-----------------------------------------------------------------------------

\renewcommand{\foottextfont}{\itshape\footnotesize} 
% Font settings for footnotes

\setlength{\footmarkwidth}{-0.15em} 
% Space between the footnote number and the text

\setlength{\footmarksep}{.1em} 
% Space between multiple footnotes on the same page

\renewcommand*{\footnoterule}{} 
% Remove the rule above the first footnote

\setlength{\skip\footins}{1\onelineskip} 
% Space between the body text and the footnote

%-----------------------------------------------------------------------------
%	HEADER AND FOOTER FORMATS
%-----------------------------------------------------------------------------

\makepagestyle{mio} % Define a new custom page style
\setlength{\headwidth}{\textwidth} % Header the same width as the text
%\makeheadrule{mio}{\textwidth}{0.1mm} % Header rule height
%\makeoddhead{mio}{\scriptsize{\theauthor\hskip.2cm\vrule\hskip.2cm\itshape{\footnotesize \thetitle}}}{}{} % Header specification
\makeoddfoot{mio}{}{\large {\thepage}}{} % Footer specification
\makeevenfoot{mio}{}{\large {\thepage}}{} % Footer specification
\makeoddfoot{plain}{}{\large {\thepage}}{} % Pages of chapters
\makeevenfoot{plain}{}{\large {\thepage}}{} % Pages of chapters
\pagestyle{mio} % Set the page style to the custom style defined above

%-----------------------------------------------------------------------------
%	PART FORMAT
%-----------------------------------------------------------------------------

\renewcommand{\partnamefont}{\centering\sffamily\itshape\Huge} % Part name font specification
\renewcommand{\partnumfont}{\sffamily\Huge} % Part number font specification
\renewcommand{\parttitlefont}{\centering\sffamily\scshape} % Part title font specification
\renewcommand{\beforepartskip}{\null\vskip.618\textheight} % Whitespace above the part heading

%-----------------------------------------------------------------------------
%	CHAPTER FORMAT
%-----------------------------------------------------------------------------

\usepackage{fourier} % or what ever
\usepackage{color,calc}
\newsavebox{\ChpNumBox}
\definecolor[named]{ChapBlue}{rgb}{0.1,0.4,0.6}
\definecolor[named]{Grey}{rgb}{0.8,0.8,0.8}
\makeatletter
\newcommand
*
{\thickhrulefill}{%
\leavevmode\leaders\hrule height 1\p@ \hfill \kern \z@}
\newcommand
*
\BuildChpNum[2]{%
  \begin{tabular}[t]{@{}c@{}}
  \makebox[0pt][c]{#1\strut} \\[0.5ex]
  \colorbox{ChapBlue}{%
\rule[-8em]{0pt}{0pt}%
\rule{1em}{0pt}\color{white}#2\strut
\rule{1ex}{0pt}}%
  \end{tabular}
}
\makechapterstyle{BlueBox}{%
  \renewcommand{\chapnamefont}{\large\scshape}
  \renewcommand{\chapnumfont}{\Huge\bfseries}
  \renewcommand{\chaptitlefont}{\raggedright\Large\bfseries}
  \setlength{\beforechapskip}{10pt}
  \setlength{\midchapskip}{6pt}
  \setlength{\afterchapskip}{20pt}
  \renewcommand{\printchaptername}{}
  \renewcommand{\chapternamenum}{}
  \renewcommand{\printchapternum}{%
\sbox{\ChpNumBox}{%
\BuildChpNum{\chapnamefont\@chapapp}%
{\chapnumfont\thechapter}} }
  \renewcommand{\printchapternonum}{%
\sbox{\ChpNumBox}{%
\BuildChpNum{\chapnamefont\vphantom{\@chapapp}}%
{\chapnumfont\hphantom{\thechapter}}}}
  \renewcommand{\afterchapternum}{}
  \renewcommand{\printchaptertitle}[1]{%
\usebox{\ChpNumBox}\hfill
\parbox[t]{\hsize-\wd\ChpNumBox-1em}{%
  \vspace{\midchapskip}%
  \thickhrulefill\par
  \chaptitlefont ##1\par}}%
}




%-----------------------------------------------------------------------------
%	SECTION FORMAT
%-----------------------------------------------------------------------------

\setsecheadstyle{\sethangfrom{\noindent ##1}\raggedright\sffamily\itshape\Large} % Section title font specification
\setbeforesecskip{-.6\onelineskip} % Whitespace before the section
\setaftersecskip{.3\onelineskip} % Whitespace after the section

%-----------------------------------------------------------------------------
%	SUBSECTION FORMAT
%-----------------------------------------------------------------------------

\setsubsecheadstyle{\sethangfrom{\noindent  ##1}\raggedright\sffamily\large\itshape} % Subsection title font specification
\setbeforesubsecskip{-.5\onelineskip} % Whitespace before the subsection
\setaftersubsecskip{.2\onelineskip} % Whitespace after the subsection

%-----------------------------------------------------------------------------
%	SUBSUBSECTION FORMAT
%-----------------------------------------------------------------------------

\setsubsubsecheadstyle{\sethangfrom{\noindent ##1}\raggedright\sffamily\itshape} % Subsubsection title font specification
\setbeforesubsubsecskip{-.5\onelineskip} % Whitespace before the subsubsection
\setaftersubsubsecskip{.1\onelineskip} % Whitespace after the subsubsection

%-----------------------------------------------------------------------------
%	CAPTION FORMAT
%-----------------------------------------------------------------------------
\usepackage[labelformat=empty,labelfont=it,textfont={it},font=small]{caption}

\captiontitlefont{\itshape\footnotesize} % Caption font specification
\captionnamefont{\footnotesize} % "Caption" text font specification
\captionfont{\itshape\footnotesize}

%il codice seguente elimina gli spazi nella lista delle figure tra
% tra un capitolo e l'altro.
\makeatletter
\def\@chapter[#1]#2{\ifnum \c@secnumdepth >\m@ne
                          \refstepcounter{chapter}%
                          \typeout{\@chapapp\space\thechapter.}%
                          \addcontentsline{toc}{chapter}%
                                    {\protect\numberline{\thechapter}#1}%
                     \else
                       \addcontentsline{toc}{chapter}{#1}%
                     \fi
                     \chaptermark{#1}%
                     \if@twocolumn
                       \@topnewpage[\@makechapterhead{#2}]%
                     \else
                       \@makechapterhead{#2}%
                       \@afterheading
                     \fi}
\makeatother

%-----------------------------------------------------------------------------
%	QUOTATION ENVIRONMENT FORMAT
%-----------------------------------------------------------------------------

\renewenvironment{quotation}
{\par\leftskip=1em\vskip.5\onelineskip\em}
{\par\vskip.5\onelineskip}

%-----------------------------------------------------------------------------
%	QUOTE ENVIRONMENT FORMAT
%-----------------------------------------------------------------------------

\renewenvironment{quote}
{\list{}{\em\leftmargin=1em}\item[]}{\endlist\relax}

%-----------------------------------------------------------------------------
%	MISCELLANEOUS DOCUMENT SPECIFICATIONS
%-----------------------------------------------------------------------------

\setlength{\parindent}{0.7em}

\midsloppy % Fewer overfull lines - used in the memoir class and allows a setting somewhere between \fussy and \sloppy

\checkandfixthelayout % Tell memoir to implement the above

